<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Á∑ö‰∏äËâ≤Âç°Ë≥áÊñôÂ∫´</title>
    
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='48' fill='%23D4F0F6' /><circle cx='50' cy='30' r='15' fill='%230068A7' /><circle cx='70' cy='45' r='15' fill='%23F8B5B5' /><circle cx='62' cy='70' r='15' fill='%230068A7' /><circle cx='38' cy='70' r='15' fill='%23F8B5B5' /><circle cx='30' cy='45' r='15' fill='%230068A7' /><circle cx='50' cy='50' r='10' fill='white' /></svg>">
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <style>
        :root {
            /* Winter Blossom ‰∏ªÈ°åËâ≤Ê®ô */
            --color-winter-blue: #0068A7;
            --color-winter-pale: #D4F0F6;
            --color-winter-pink: #F8B5B5;
            --white: #ffffff;
            --text-dark: #2c3e50;
            --shadow: 0 8px 30px rgba(0, 104, 167, 0.15);
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--color-winter-pale);
            color: var(--text-dark);
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        header {
            text-align: center;
            padding: 50px 20px;
            background: linear-gradient(135deg, var(--color-winter-blue), #004d7c);
            color: var(--white);
            box-shadow: 0 10px 40px rgba(0, 104, 167, 0.3);
            position: relative;
        }

        .brand-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .brand-logo {
            width: 50px;
            height: 50px;
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
        }

        .brand-logo:hover {
            transform: rotate(72deg);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .search-container {
            max-width: 600px;
            margin: -35px auto 40px;
            position: relative;
            z-index: 10;
        }

        .search-box {
            width: 100%;
            padding: 15px 25px;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            outline: none;
            box-shadow: var(--shadow);
            font-family: 'Noto Sans TC', sans-serif;
        }

        .grid-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            margin-bottom: 50px;
        }

        .sheet-title {
            grid-column: 1 / -1;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--color-winter-blue);
            margin: 40px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 3px solid var(--color-winter-pink);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .color-card {
            background: var(--white);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .color-card:hover { transform: translateY(-8px); }

        .color-card img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            border-bottom: 2px solid var(--color-winter-pink);
        }

        .color-swatches {
            height: 120px;
            display: flex;
        }

        .swatch {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
            text-shadow: 0 1px 3px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: flex 0.3s;
        }

        .swatch:hover { flex: 1.5; }

        .card-body { padding: 20px; flex: 1; }

        .card-title {
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--color-winter-blue);
            margin-bottom: 10px;
        }

        .card-desc {
            font-size: 0.95rem;
            color: #636e72;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .btn-copy-all {
            background: var(--color-winter-blue);
            color: var(--white);
            border: none;
            padding: 10px;
            border-radius: 10px;
            width: 100%;
            font-weight: 700;
            cursor: pointer;
            font-family: 'Noto Sans TC', sans-serif;
            transition: background 0.2s;
        }

        .btn-copy-all:hover { background: var(--color-winter-pink); }

        #toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--text-dark);
            color: var(--white);
            padding: 12px 30px;
            border-radius: 50px;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 9999;
        }

        .loading-state { text-align: center; padding: 50px; color: var(--color-winter-blue); }
        .spinner {
            width: 40px; height: 40px; border: 4px solid rgba(0, 104, 167, 0.1);
            border-left-color: var(--color-winter-blue); border-radius: 50%;
            animation: spin 1s linear infinite; margin: 0 auto 20px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

<header>
    <div class="brand-container">
        <svg class="brand-logo" viewBox="0 0 100 100">
            <circle cx="50" cy="50" r="48" fill="#D4F0F6" />
            <circle cx="50" cy="30" r="15" fill="#0068A7" />
            <circle cx="70" cy="45" r="15" fill="#F8B5B5" />
            <circle cx="62" cy="70" r="15" fill="#0068A7" />
            <circle cx="38" cy="70" r="15" fill="#F8B5B5" />
            <circle cx="30" cy="45" r="15" fill="#0068A7" />
            <circle cx="50" cy="50" r="10" fill="white" />
        </svg>
        <h1>Á∑ö‰∏äËâ≤Âç°Ë≥áÊñôÂ∫´</h1>
    </div>
    <p>ÂÖ®Êñπ‰ΩçÁæéÂ≠∏ÁÆ°ÁêÜÁ≥ªÁµ±</p>
</header>

<div class="container">
    <div class="search-container">
        <input type="text" id="searchInput" class="search-box" placeholder="üîç ÊêúÂ∞ãÈÖçËâ≤ÂêçÁ®±„ÄÅHEX ÊàñÈóúÈçµË©û...">
    </div>

    <div id="loading" class="loading-state">
        <div class="spinner"></div>
        <p>Ê≠£Âú®ËºâÂÖ•ÁæéÂ≠∏ÂÆáÂÆô...</p>
    </div>

    <div id="resultArea"></div>
</div>

<div id="toast">Â∑≤Ë§áË£ΩÊàêÂäü</div>

<script>
    const resultArea = document.getElementById('resultArea');
    const searchInput = document.getElementById('searchInput');
    const loading = document.getElementById('loading');

    // È†ÅÈù¢ËºâÂÖ•Ëá™ÂãïËÆÄÂèñ
    window.addEventListener('load', () => {
        fetch('./color.xlsx')
            .then(res => res.arrayBuffer())
            .then(data => {
                const workbook = XLSX.read(new Uint8Array(data), {type: 'array'});
                processWorkbook(workbook);
            })
            .catch(err => {
                loading.innerHTML = "<p>‚ö†Ô∏è Êâæ‰∏çÂà∞ color.xlsxÔºåË´ãÁ¢∫Ë™çÊ™îÊ°àÂ∑≤‰∏äÂÇ≥Ëá≥ GitHub„ÄÇ</p>";
            });
    });

    function processWorkbook(workbook) {
        resultArea.innerHTML = '';
        workbook.SheetNames.forEach(sheetName => {
            const worksheet = workbook.Sheets[sheetName];
            const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});
            if (jsonData.length > 1) renderSheet(sheetName, jsonData);
        });
        loading.style.display = 'none';
    }

    function renderSheet(name, data) {
        const section = document.createElement('div');
        const grid = document.createElement('div');
        grid.className = 'grid-section';

        const title = document.createElement('div');
        title.className = 'sheet-title';
        title.innerHTML = `<span>${name}</span>`;
        section.appendChild(title);
        section.appendChild(grid);

        for (let i = 1; i < data.length; i++) {
            const row = data[i];
            if (!row || row.length === 0) continue;

            let colors = [], texts = [], image = null;

            row.forEach(cell => {
                const str = String(cell || "").trim();
                if (str.match(/#?([0-9A-Fa-f]{6}|[0-9A-Fa-f]{3})/)) {
                    colors.push(str.startsWith('#') ? str : '#' + str);
                } else if (str.match(/\.(jpg|jpeg|png|webp|gif)$/i)) {
                    image = str;
                } else if (str !== "") {
                    // Ê†°Ê≠£Ê†åÂ≠óÁÇ∫Ê´®
                    texts.push(str.replace(/Ê†å/g, 'Ê´®'));
                }
            });

            if (colors.length > 0) {
                const card = createCard(colors, texts, image);
                grid.appendChild(card);
            }
        }
        resultArea.appendChild(section);
    }

    function createCard(colors, texts, image) {
        const card = document.createElement('div');
        card.className = 'color-card';

        if (image) {
            const img = document.createElement('img');
            img.src = `./${image}`;
            img.onerror = () => img.style.display = 'none';
            card.appendChild(img);
        }

        const swatches = document.createElement('div');
        swatches.className = 'color-swatches';
        colors.forEach(c => {
            const s = document.createElement('div');
            s.className = 'swatch';
            s.style.backgroundColor = c;
            s.style.color = getContrast(c);
            s.innerText = c;
            s.onclick = () => copyText(c);
            swatches.appendChild(s);
        });
        card.appendChild(swatches);

        const body = document.createElement('div');
        body.className = 'card-body';
        const title = texts.length > 0 ? texts[0] : 'Êú™ÂëΩÂêçÈÖçËâ≤';
        const desc = texts.length > 1 ? texts.slice(1).join(' / ') : '';
        body.innerHTML = `<div class="card-title">${title}</div><div class="card-desc">${desc}</div>`;
        
        const btn = document.createElement('button');
        btn.className = 'btn-copy-all';
        btn.innerText = 'Ë§áË£ΩÊâÄÊúâ‰ª£Á¢º';
        btn.onclick = () => copyText(colors.join(', '));
        body.appendChild(btn);

        card.appendChild(body);
        return card;
    }

    // ÊêúÂ∞ãÈÅéÊøæ
    searchInput.addEventListener('input', (e) => {
        const term = e.target.value.toLowerCase();
        document.querySelectorAll('.color-card').forEach(card => {
            card.style.display = card.innerText.toLowerCase().includes(term) ? 'flex' : 'none';
        });
    });

    function copyText(text) {
        if (navigator.clipboard) {
            navigator.clipboard.writeText(text).then(() => showToast(text));
        } else {
            const ta = document.createElement("textarea");
            ta.value = text; document.body.appendChild(ta);
            ta.select(); document.execCommand('copy');
            document.body.removeChild(ta); showToast(text);
        }
    }

    function showToast(txt) {
        const t = document.getElementById('toast');
        t.innerText = `Â∑≤Ë§áË£ΩÔºö${txt}`; t.style.opacity = 1;
        setTimeout(() => t.style.opacity = 0, 2000);
    }

    function getContrast(hex) {
        hex = hex.replace('#', '');
        if (hex.length === 3) hex = hex.split('').map(s => s + s).join('');
        const r = parseInt(hex.substr(0, 2), 16), g = parseInt(hex.substr(2, 2), 16), b = parseInt(hex.substr(4, 2), 16);
        return ((r * 299 + g * 587 + b * 114) / 1000) > 128 ? '#000' : '#fff';
    }
</script>
</body>
</html>
